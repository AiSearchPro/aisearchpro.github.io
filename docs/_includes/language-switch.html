<!-- 语言切换组件 -->
<div class="language-switch">
  <button class="lang-btn" data-lang="zh" {% if site.default_lang == 'zh' %}class="active"{% endif %}>
    中文
  </button>
  <button class="lang-btn" data-lang="en" {% if site.default_lang == 'en' %}class="active"{% endif %}>
    English
  </button>
</div>

<style>
.language-switch {
  display: flex;
  gap: 4px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 2px;
}

.lang-btn {
  padding: 6px 12px;
  border: none;
  background: transparent;
  color: var(--muted);
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s ease;
}

.lang-btn:hover {
  color: var(--text);
  background: rgba(255, 255, 255, 0.05);
}

.lang-btn.active {
  color: var(--text);
  background: var(--accent);
}
</style>

<script>
// 语言切换功能
document.addEventListener('DOMContentLoaded', function() {
  const langButtons = document.querySelectorAll('.lang-btn');
  const currentLang = localStorage.getItem('preferred-language') || 'zh';
  
  // 设置初始语言状态
  setLanguage(currentLang);
  
  // 绑定切换事件
  langButtons.forEach(btn => {
    btn.addEventListener('click', function() {
      const lang = this.dataset.lang;
      setLanguage(lang);
      localStorage.setItem('preferred-language', lang);
    });
  });
  
  function setLanguage(lang) {
    // 更新按钮状态
    langButtons.forEach(btn => {
      btn.classList.toggle('active', btn.dataset.lang === lang);
    });
    
    // 更新页面内容
    updatePageContent(lang);
    
    // 更新 HTML lang 属性
    document.documentElement.lang = lang === 'zh' ? 'zh-CN' : 'en';
  }
  
  function updatePageContent(lang) {
    const translations = {
      zh: {
        title: 'AI Search Pro · 精选 AI 工具与应用 · 每日更新',
        tagline: '精选最佳 AI 工具与应用 · 每日更新',
        subtitle: '按使用场景与工具类型分类，帮助你以更低成本、更高效率找到合适的 AI 解决方案。支持中文优先、免登录/免信用卡筛选，覆盖 ChatGPT、Claude、Gemini、Midjourney、SDXL 等主流模型。',
        nav: {
          featured: '热门',
          updates: '更新',
          use_cases: '使用场景',
          tool_types: '工具类型',
          collections: '合集',
          guides: '教程'
        },
        buttons: {
          discover: '立即发现工具',
          submit: '提交/推荐工具',
          search: '搜索'
        },
        search_placeholder: '搜索关键词（如：写作、绘图、字幕、开源、中文、免费）',
        sections: {
          featured: '热门推荐 Featured Picks',
          featured_sub: '人工精选/热度靠前 · 快速上手',
          updates: '今日/本周更新 Today / This Week',
          updates_sub: '持续新增与校准，体现"每日更新"的承诺',
          use_cases: '使用场景 Use Cases',
          use_cases_sub: '按真实需求组织，更贴近新手心智',
          tool_types: '工具类型 Tool Types',
          tool_types_sub: '按产品形态/使用方式划分',
          collections: '合集与对比 Collections & Comparisons',
          guides: '教程与指南 Guides & Tutorials'
        },
        footer: '© AI Search Pro · 每日更新'
      },
      en: {
        title: 'AI Search Pro · Curated AI Tools & Applications · Daily Updates',
        tagline: 'Curated Best AI Tools & Applications · Daily Updates',
        subtitle: 'Organized by use cases and tool types to help you find the right AI solutions with lower cost and higher efficiency. Supports Chinese-first, no-login/no-credit-card filtering, covering mainstream models like ChatGPT, Claude, Gemini, Midjourney, SDXL.',
        nav: {
          featured: 'Featured',
          updates: 'Updates',
          use_cases: 'Use Cases',
          tool_types: 'Tool Types',
          collections: 'Collections',
          guides: 'Guides'
        },
        buttons: {
          discover: 'Discover Tools Now',
          submit: 'Submit/Recommend Tools',
          search: 'Search'
        },
        search_placeholder: 'Search keywords (e.g.: writing, drawing, subtitles, open source, Chinese, free)',
        sections: {
          featured: 'Featured Picks 热门推荐',
          featured_sub: 'Hand-picked / Top trending · Quick start',
          updates: 'Today / This Week 今日/本周更新',
          updates_sub: 'Continuous additions and calibrations, demonstrating our "daily update" commitment',
          use_cases: 'Use Cases 使用场景',
          use_cases_sub: 'Organized by real needs, more beginner-friendly',
          tool_types: 'Tool Types 工具类型',
          tool_types_sub: 'Categorized by product form/usage method',
          collections: 'Collections & Comparisons 合集与对比',
          guides: 'Guides & Tutorials 教程与指南'
        },
        footer: '© AI Search Pro · Daily Updates'
      }
    };
    
    // 标签兜底翻译字典（中英互译）
    const tagDict = {
      '文档': { zh: '文档', en: 'Documents' },
      '邮件': { zh: '邮件', en: 'Email' },
      '会议': { zh: '会议', en: 'Meetings' },
      '笔记': { zh: '笔记', en: 'Notes' },
      '管理': { zh: '管理', en: 'Management' },
      '知识库': { zh: '知识库', en: 'Knowledge Base' },
      '写作': { zh: '写作', en: 'Writing' },
      '语法': { zh: '语法', en: 'Grammar' },
      '英文': { zh: '英文', en: 'English' },
      '代码补全': { zh: '代码补全', en: 'Code Completion' },
      '编程': { zh: '编程', en: 'Programming' },
      '编辑器': { zh: '编辑器', en: 'Editor' },
      'AI编程': { zh: 'AI编程', en: 'AI Coding' },
      '开发': { zh: '开发', en: 'Development' },
      '在线编程': { zh: '在线编程', en: 'Online Coding' },
      '协作': { zh: '协作', en: 'Collaboration' },
      '学习': { zh: '学习', en: 'Learning' },
      '图像生成': { zh: '图像生成', en: 'Image Generation' },
      '艺术': { zh: '艺术', en: 'Art' },
      '创意': { zh: '创意', en: 'Creative' },
      '设计': { zh: '设计', en: 'Design' },
      '模板': { zh: '模板', en: 'Templates' },
      '图像': { zh: '图像', en: 'Images' },
      '搜索': { zh: '搜索', en: 'Search' },
      '研究': { zh: '研究', en: 'Research' },
      '分析': { zh: '分析', en: 'Analysis' },
      '学术': { zh: '学术', en: 'Academic' },
      '学习卡片': { zh: '学习卡片', en: 'Flashcards' },
      '记忆': { zh: '记忆', en: 'Memory' },
      '训练': { zh: '训练', en: 'Training' },
      '音乐生成': { zh: '音乐生成', en: 'Music Generation' },
      '创作': { zh: '创作', en: 'Creation' },
      '娱乐': { zh: '娱乐', en: 'Entertainment' },
      '视频生成': { zh: '视频生成', en: 'Video Generation' },
      '编辑': { zh: '编辑', en: 'Editing' },
      '角色扮演': { zh: '角色扮演', en: 'Roleplay' },
      '对话': { zh: '对话', en: 'Chat' },
      'GitHub': { zh: 'GitHub', en: 'GitHub' },
      // 工具类型页面标签补充
      'GPT-4o': { zh: 'GPT-4o', en: 'GPT-4o' },
      '通用': { zh: '通用', en: 'General' },
      '长文本': { zh: '长文本', en: 'Long Text' },
      '安全': { zh: '安全', en: 'Safe' },
      '多模态': { zh: '多模态', en: 'Multimodal' },
      'Google': { zh: 'Google', en: 'Google' },
      '免费': { zh: '免费', en: 'Free' },
      '高质量': { zh: '高质量', en: 'High Quality' },
      'Discord': { zh: 'Discord', en: 'Discord' },
      'OpenAI': { zh: 'OpenAI', en: 'OpenAI' },
      '精确': { zh: '精确', en: 'Precise' },
      '开源': { zh: '开源', en: 'Open Source' },
      '可定制': { zh: '可定制', en: 'Customizable' },
      '专业': { zh: '专业', en: 'Professional' },
      '视频编辑': { zh: '视频编辑', en: 'Video Editing' },
      '简单': { zh: '简单', en: 'Simple' },
      '快速': { zh: '快速', en: 'Fast' },
      '3D': { zh: '3D', en: '3D' },
      '创新': { zh: '创新', en: 'Innovative' },
      '技术': { zh: '技术', en: 'Technology' },
      '音乐': { zh: '音乐', en: 'Music' },
      '歌曲': { zh: '歌曲', en: 'Songs' },
      '语音合成': { zh: '语音合成', en: 'Voice Synthesis' },
      '克隆': { zh: '克隆', en: 'Cloning' },
      '多语言': { zh: '多语言', en: 'Multilingual' },
      '背景音乐': { zh: '背景音乐', en: 'Background Music' },
      '实时': { zh: '实时', en: 'Real-time' },
      '商用': { zh: '商用', en: 'Commercial' },
      '营销': { zh: '营销', en: 'Marketing' },
      '文案': { zh: '文案', en: 'Copywriting' },
      '商业': { zh: '商业', en: 'Business' },
      '多用途': { zh: '多用途', en: 'Multi-purpose' },
      'SEO': { zh: 'SEO', en: 'SEO' },
      '优化': { zh: '优化', en: 'Optimization' },
      'IDE': { zh: 'IDE', en: 'IDE' }
    };
    // 反向映射（英文->中文）
    const reverseTagDict = Object.fromEntries(Object.entries(tagDict).map(([zh, pair]) => [pair.en, zh]));

    const t = translations[lang];
    
    // 更新页面标题
    document.title = t.title;
    
    // 更新导航
    const navLinks = document.querySelectorAll('.nav a');
    navLinks.forEach(link => {
      // 兼容带 baseurl 的完整链接，统一基于 hash 判断
      const hash = link.hash || (() => {
        const href = link.getAttribute('href') || '';
        const idx = href.indexOf('#');
        return idx >= 0 ? href.slice(idx) : '';
      })();
      if (hash === '#featured') link.textContent = t.nav.featured;
      else if (hash === '#updates') link.textContent = t.nav.updates;
      else if (hash === '#use-cases') link.textContent = t.nav.use_cases;
      else if (hash === '#tool-types') link.textContent = t.nav.tool_types;
      else if (hash === '#collections') link.textContent = t.nav.collections;
      else if (hash === '#guides') link.textContent = t.nav.guides;
    });
    
    // 更新主要内容
    const heroTitle = document.querySelector('.hero h1');
    if (heroTitle) heroTitle.textContent = t.tagline;
    
    const heroSubtitle = document.querySelector('.hero p');
    if (heroSubtitle) heroSubtitle.textContent = t.subtitle;
    
    const discoverBtn = document.querySelector('.btn.primary');
    if (discoverBtn) discoverBtn.textContent = t.buttons.discover;
    
    const submitBtn = document.querySelector('.btn:not(.primary)');
    if (submitBtn) submitBtn.textContent = t.buttons.submit;
    
    const searchInput = document.querySelector('.search input');
    if (searchInput) searchInput.placeholder = t.search_placeholder;
    
    const searchBtn = document.querySelector('.search button');
    if (searchBtn) searchBtn.textContent = t.buttons.search;
    
    // 更新各个区块标题
    const sections = document.querySelectorAll('section h2');
    sections.forEach(section => {
      const id = section.parentElement.parentElement.id;
      if (id && t.sections[id]) {
        section.textContent = t.sections[id];
      }
    });
    
    // 更新子标题
    const subs = document.querySelectorAll('.sub');
    subs.forEach(sub => {
      const sectionId = sub.parentElement.parentElement.id;
      if (sectionId && t.sections[sectionId + '_sub']) {
        sub.textContent = t.sections[sectionId + '_sub'];
      }
    });
    
    // 更新页脚
    const footer = document.querySelector('footer .wrap div');
    if (footer) {
      footer.innerHTML = t.footer + ' · <a href="https://github.com/aisearchpro/aisearchpro.github.io" target="_blank" rel="noopener">GitHub</a>';
    }
    
    // 更新工具卡片的meta描述
    const metaElements = document.querySelectorAll('.meta[data-zh][data-en]');
    metaElements.forEach(meta => {
      const zhText = meta.getAttribute('data-zh');
      const enText = meta.getAttribute('data-en');
      meta.textContent = lang === 'zh' ? zhText : enText;
    });
    
    // 更新updates区域的标题和类型
    const updateTitles = document.querySelectorAll('.update-title[data-zh][data-en]');
    updateTitles.forEach(title => {
      const zhText = title.getAttribute('data-zh');
      const enText = title.getAttribute('data-en');
      title.textContent = lang === 'zh' ? zhText : enText;
    });
    
    const updateTypes = document.querySelectorAll('.update-type[data-zh][data-en]');
    updateTypes.forEach(type => {
      const zhText = type.getAttribute('data-zh');
      const enText = type.getAttribute('data-en');
      type.textContent = lang === 'zh' ? zhText : enText;
    });

    // 更新Use Cases区域的标题
    document.querySelectorAll('.use-case-title[data-zh][data-en]').forEach(element => {
      element.textContent = element.getAttribute(`data-${lang}`);
    });

    // 更新区域标题和副标题
    document.querySelectorAll('.section-title[data-zh][data-en]').forEach(element => {
      element.textContent = element.getAttribute(`data-${lang}`);
    });
    document.querySelectorAll('.section-subtitle[data-zh][data-en]').forEach(element => {
      element.textContent = element.getAttribute(`data-${lang}`);
    });
    
    // 更新标签翻译（优先使用 data- 属性）
    document.querySelectorAll('.tag[data-zh][data-en]').forEach(element => {
      element.textContent = element.getAttribute(`data-${lang}`);
    });
    // 对没有 data-* 的标签使用兜底字典
    document.querySelectorAll('.tool-tags .tag:not([data-zh])').forEach(element => {
      const raw = (element.textContent || '').trim();
      if (!raw) return;
      if (lang === 'en') {
        // 中文 -> 英文
        if (tagDict[raw]) element.textContent = tagDict[raw].en;
      } else {
        // 英文 -> 中文
        if (reverseTagDict[raw]) element.textContent = reverseTagDict[raw];
      }
    });
    
    // 更新工具类型卡片标题
    document.querySelectorAll('.tool-type-title[data-zh][data-en]').forEach(element => {
      element.textContent = element.getAttribute(`data-${lang}`);
    });
    
    // 更新工具类型/使用场景子页面标题、描述与工具描述
    document.querySelectorAll('.category-title[data-zh][data-en]').forEach(el => {
      el.textContent = el.getAttribute(`data-${lang}`);
    });
    document.querySelectorAll('.category-description[data-zh][data-en]').forEach(el => {
      el.textContent = el.getAttribute(`data-${lang}`);
    });
    document.querySelectorAll('.tool-description[data-zh][data-en]').forEach(el => {
      el.textContent = el.getAttribute(`data-${lang}`);
    });

    // 更新"返回使用场景"链接
    document.querySelectorAll('.back-to-use-cases[data-zh][data-en]').forEach(link => {
      link.textContent = link.getAttribute(`data-${lang}`);
    });

    // 更新"返回工具类型"链接
    document.querySelectorAll('.back-to-tool-types[data-zh][data-en]').forEach(link => {
      link.textContent = link.getAttribute(`data-${lang}`);
    });

    // 更新工具类型页面未找到分支的标题和描述
    document.querySelectorAll('.not-found-title[data-zh][data-en]').forEach(element => {
      element.textContent = element.getAttribute(`data-${lang}`);
    });
    document.querySelectorAll('.not-found-description[data-zh][data-en]').forEach(element => {
      element.textContent = element.getAttribute(`data-${lang}`);
    });
    
    // 更新合集链接标题
    document.querySelectorAll('.collection-link[data-zh][data-en]').forEach(link => {
      link.textContent = lang === 'en' ? link.getAttribute('data-en') : link.getAttribute('data-zh');
    });
    
    // 更新教程指南链接标题
    document.querySelectorAll('.guide-link[data-zh][data-en]').forEach(link => {
      link.textContent = lang === 'en' ? link.getAttribute('data-en') : link.getAttribute('data-zh');
    });
    
    // 合集文案页：标题、副标题、返回链接
    document.querySelectorAll('.article-title[data-zh][data-en]').forEach(el => {
      el.textContent = el.getAttribute(`data-${lang}`);
    });
    document.querySelectorAll('.article-subtitle[data-zh][data-en]').forEach(el => {
      el.textContent = el.getAttribute(`data-${lang}`);
    });
    document.querySelectorAll('.back-to-collections[data-zh][data-en]').forEach(link => {
      link.textContent = link.getAttribute(`data-${lang}`);
    });
    
    // 合集文案页：章节标题与列表项（若带 data-zh/data-en 则切换）
    document.querySelectorAll('.collection-article [data-zh][data-en]').forEach(el => {
      el.textContent = el.getAttribute(`data-${lang}`);
    });
 
   }
});
</script>